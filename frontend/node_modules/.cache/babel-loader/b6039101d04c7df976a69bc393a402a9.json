{"ast":null,"code":"var _jsxFileName = \"/home/yussef/Desktop/current_project/Udacity_FullStack_Projects/02_trivia_api/frontend/src/components/QuizView.js\";\nimport React, { Component } from 'react';\nimport $ from 'jquery';\nimport '../stylesheets/QuizView.css';\nconst questionsPerPlay = 5;\n\nclass QuizView extends Component {\n  constructor(props) {\n    super();\n\n    this.selectCategory = ({\n      type,\n      id = 0\n    }) => {\n      this.setState({\n        quizCategory: {\n          type,\n          id\n        }\n      }, this.getFirstQuestion);\n    };\n\n    this.handleChange = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.getFirstQuestion = () => {\n      $.ajax({\n        url: '/api/quizzes?category=' + this.state.quizCategory.id,\n        type: 'GET',\n        success: result => {\n          this.setState({\n            showAnswer: false,\n            currentQuestion: result.question,\n            guess: '',\n            forceEnd: result.question ? false : true\n          });\n        },\n        error: error => {\n          alert('Unable to load question. Please try your request again');\n          return;\n        }\n      });\n    };\n\n    this.getNextQuestion = () => {\n      const previousQuestions = [...this.state.previousQuestions];\n\n      if (this.state.currentQuestion.id) {\n        previousQuestions.push(this.state.currentQuestion.id);\n      }\n\n      console.log(previousQuestions);\n      console.log(this.state.quizCategory.id);\n      var url = '/api/quizzes?category=' + this.state.quizCategory.id;\n\n      for (var i = 0; i < previousQuestions.length; i++) {\n        url += '&prev_question=' + previousQuestions[i];\n      }\n\n      console.log('Url: ' + url);\n      $.ajax({\n        url: '/api/quizzes?category=' + //TODO: update request URL\n        this.state.quizCategory.id + '&prev_question=' + this.state.currentQuestion.id,\n        type: \"GET\",\n        success: result => {\n          this.setState({\n            showAnswer: false,\n            previousQuestions: previousQuestions,\n            currentQuestion: result.question,\n            guess: '',\n            forceEnd: result.question ? false : true\n          });\n          return;\n        },\n        error: error => {\n          alert('Unable to load question. Please try your request again');\n          return;\n        }\n      });\n    };\n\n    this.submitGuess = event => {\n      event.preventDefault();\n      const formatGuess = this.state.guess.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").toLowerCase();\n      let evaluate = this.evaluateAnswer();\n      this.setState({\n        numCorrect: !evaluate ? this.state.numCorrect : this.state.numCorrect + 1,\n        showAnswer: true\n      });\n    };\n\n    this.restartGame = () => {\n      this.setState({\n        quizCategory: null,\n        previousQuestions: [],\n        showAnswer: false,\n        numCorrect: 0,\n        currentQuestion: {},\n        guess: '',\n        forceEnd: false\n      });\n    };\n\n    this.evaluateAnswer = () => {\n      const formatGuess = this.state.guess.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").toLowerCase();\n      const answerArray = this.state.currentQuestion.answer.toLowerCase().split(' ');\n      return answerArray.includes(formatGuess);\n    };\n\n    this.state = {\n      quizCategory: null,\n      previousQuestions: [],\n      showAnswer: false,\n      categories: [],\n      numCorrect: 0,\n      currentQuestion: {},\n      guess: '',\n      forceEnd: false\n    };\n  }\n\n  componentDidMount() {\n    $.ajax({\n      url: \"/api/categories\",\n      //TODO: update request URL\n      type: \"GET\",\n      success: result => {\n        this.setState({\n          categories: result.categories\n        });\n        return;\n      },\n      error: error => {\n        alert('Unable to load categories. Please try your request again');\n        return;\n      }\n    });\n  }\n\n  renderPrePlay() {\n    return React.createElement(\"div\", {\n      className: \"quiz-play-holder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"choose-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, \"Choose Category\"), React.createElement(\"div\", {\n      className: \"category-holder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"play-category\",\n      onClick: this.selectCategory,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, \"ALL\"), this.state.categories.map(category => {\n      // console.log(category)\n      return React.createElement(\"div\", {\n        key: category.id,\n        value: category.id,\n        className: \"play-category\",\n        onClick: () => this.selectCategory({\n          type: category.type,\n          id: category.id\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, category.type);\n    } // {Object.keys(this.state.categories).map(id => {\n    // return (\n    //   <div\n    //     key={id}\n    //     value={id}\n    //     className=\"play-category\"\n    //     onClick={() => this.selectCategory({type:this.state.categories[id], id})}>\n    //     {this.state.categories[id]}\n    //   </div>\n    // )\n    // }\n    )));\n  }\n\n  renderFinalScore() {\n    return React.createElement(\"div\", {\n      className: \"quiz-play-holder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"final-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, \" Your Final Score is \", this.state.numCorrect), React.createElement(\"div\", {\n      className: \"play-again button\",\n      onClick: this.restartGame,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, \" Play Again? \"));\n  }\n\n  renderCorrectAnswer() {\n    const formatGuess = this.state.guess.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").toLowerCase();\n    let evaluate = this.evaluateAnswer();\n    return React.createElement(\"div\", {\n      className: \"quiz-play-holder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"quiz-question\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, this.state.currentQuestion.question), React.createElement(\"div\", {\n      className: \"\".concat(evaluate ? 'correct' : 'wrong'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, evaluate ? \"You were correct!\" : \"You were incorrect\"), React.createElement(\"div\", {\n      className: \"quiz-answer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, this.state.currentQuestion.answer), React.createElement(\"div\", {\n      className: \"next-question button\",\n      onClick: this.getNextQuestion,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \" Next Question \"));\n  }\n\n  renderPlay() {\n    return this.state.previousQuestions.length === questionsPerPlay || this.state.forceEnd ? this.renderFinalScore() : this.state.showAnswer ? this.renderCorrectAnswer() : React.createElement(\"div\", {\n      className: \"quiz-play-holder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"quiz-question\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, this.state.currentQuestion.question), React.createElement(\"form\", {\n      onSubmit: this.submitGuess,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      name: \"guess\",\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      className: \"submit-guess button\",\n      type: \"submit\",\n      value: \"Submit Answer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    })));\n  }\n\n  render() {\n    return this.state.quizCategory ? this.renderPlay() : this.renderPrePlay();\n  }\n\n}\n\nexport default QuizView;","map":{"version":3,"sources":["/home/yussef/Desktop/current_project/Udacity_FullStack_Projects/02_trivia_api/frontend/src/components/QuizView.js"],"names":["React","Component","$","questionsPerPlay","QuizView","constructor","props","selectCategory","type","id","setState","quizCategory","getFirstQuestion","handleChange","event","target","name","value","ajax","url","state","success","result","showAnswer","currentQuestion","question","guess","forceEnd","error","alert","getNextQuestion","previousQuestions","push","console","log","i","length","submitGuess","preventDefault","formatGuess","replace","toLowerCase","evaluate","evaluateAnswer","numCorrect","restartGame","answerArray","answer","split","includes","categories","componentDidMount","renderPrePlay","map","category","renderFinalScore","renderCorrectAnswer","renderPlay","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport $ from 'jquery';\n\nimport '../stylesheets/QuizView.css';\n\nconst questionsPerPlay = 5;\n\nclass QuizView extends Component {\n  constructor(props){\n    super();\n    this.state = {\n        quizCategory: null,\n        previousQuestions: [],\n        showAnswer: false,\n        categories: [],\n        numCorrect: 0,\n        currentQuestion: {},\n        guess: '',\n        forceEnd: false\n    }\n  }\n\n  componentDidMount(){\n    $.ajax({\n      url: `/api/categories`, //TODO: update request URL\n      type: \"GET\",\n      success: (result) => {\n        this.setState({ categories: result.categories })\n        return;\n      },\n      error: (error) => {\n        alert('Unable to load categories. Please try your request again')\n        return;\n      }\n    })\n  }\n\n  selectCategory = ({type, id=0}) => {\n    this.setState({quizCategory: {type, id}}, this.getFirstQuestion)\n  }\n\n  handleChange = (event) => {\n    this.setState({[event.target.name]: event.target.value})\n  }\n\n  getFirstQuestion = () => {\n    $.ajax({\n      url: '/api/quizzes?category=' + this.state.quizCategory.id,\n      type: 'GET',\n      success: (result) => {\n        this.setState({\n          showAnswer: false,\n          currentQuestion: result.question,\n          guess: '',\n          forceEnd: result.question ? false : true\n        })\n      },\n      error: (error) => {\n        alert('Unable to load question. Please try your request again')\n        return;\n      }\n    })\n  }\n\n  getNextQuestion = () => {\n    const previousQuestions = [...this.state.previousQuestions]\n    if(this.state.currentQuestion.id) { previousQuestions.push(this.state.currentQuestion.id) }\n    console.log(previousQuestions)\n    console.log(this.state.quizCategory.id)\n    var url = '/api/quizzes?category='+this.state.quizCategory.id\n    for (var i = 0; i < previousQuestions.length; i++) {\n      url+='&prev_question=' + previousQuestions[i]\n    }\n    console.log('Url: ' + url)\n    $.ajax({\n      url: '/api/quizzes?category=' + //TODO: update request URL\n        this.state.quizCategory.id +\n        '&prev_question=' +\n        this.state.currentQuestion.id,\n      type: \"GET\",\n      success: (result) => {\n        this.setState({\n          showAnswer: false,\n          previousQuestions: previousQuestions,\n          currentQuestion: result.question,\n          guess: '',\n          forceEnd: result.question ? false : true\n        })\n        return;\n      },\n      error: (error) => {\n        alert('Unable to load question. Please try your request again')\n        return;\n      }\n    })\n  }\n\n  submitGuess = (event) => {\n    event.preventDefault();\n    const formatGuess = this.state.guess.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g,\"\").toLowerCase()\n    let evaluate =  this.evaluateAnswer()\n    this.setState({\n      numCorrect: !evaluate ? this.state.numCorrect : this.state.numCorrect + 1,\n      showAnswer: true,\n    })\n  }\n\n  restartGame = () => {\n    this.setState({\n      quizCategory: null,\n      previousQuestions: [],\n      showAnswer: false,\n      numCorrect: 0,\n      currentQuestion: {},\n      guess: '',\n      forceEnd: false\n    })\n  }\n\n  renderPrePlay(){\n      return (\n          <div className=\"quiz-play-holder\">\n              <div className=\"choose-header\">Choose Category</div>\n              <div className=\"category-holder\">\n                  <div className=\"play-category\" onClick={this.selectCategory}>ALL</div>\n                  {\n                  this.state.categories.map(category => {\n                    // console.log(category)\n                    return (\n                      <div\n                        key={category.id}\n                        value={category.id}\n                        className=\"play-category\"\n                        onClick={() => this.selectCategory({type:category.type, id:category.id})}\n                        >\n                        {category.type}\n                      </div>\n                    )}\n\n                  // {Object.keys(this.state.categories).map(id => {\n                  // return (\n                  //   <div\n                  //     key={id}\n                  //     value={id}\n                  //     className=\"play-category\"\n                  //     onClick={() => this.selectCategory({type:this.state.categories[id], id})}>\n                  //     {this.state.categories[id]}\n                  //   </div>\n                  // )\n                // }\n              )}\n              </div>\n          </div>\n      )\n  }\n\n  renderFinalScore(){\n    return(\n      <div className=\"quiz-play-holder\">\n        <div className=\"final-header\"> Your Final Score is {this.state.numCorrect}</div>\n        <div className=\"play-again button\" onClick={this.restartGame}> Play Again? </div>\n      </div>\n    )\n  }\n\n  evaluateAnswer = () => {\n    const formatGuess = this.state.guess.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g,\"\").toLowerCase()\n    const answerArray = this.state.currentQuestion.answer.toLowerCase().split(' ');\n    return answerArray.includes(formatGuess)\n  }\n\n  renderCorrectAnswer(){\n    const formatGuess = this.state.guess.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g,\"\").toLowerCase()\n    let evaluate =  this.evaluateAnswer()\n    return(\n      <div className=\"quiz-play-holder\">\n        <div className=\"quiz-question\">{this.state.currentQuestion.question}</div>\n        <div className={`${evaluate ? 'correct' : 'wrong'}`}>{evaluate ? \"You were correct!\" : \"You were incorrect\"}</div>\n        <div className=\"quiz-answer\">{this.state.currentQuestion.answer}</div>\n        <div className=\"next-question button\" onClick={this.getNextQuestion}> Next Question </div>\n      </div>\n    )\n  }\n\n  renderPlay(){\n    return this.state.previousQuestions.length === questionsPerPlay || this.state.forceEnd\n      ? this.renderFinalScore()\n      : this.state.showAnswer\n        ? this.renderCorrectAnswer()\n        : (\n          <div className=\"quiz-play-holder\">\n            <div className=\"quiz-question\">{this.state.currentQuestion.question}</div>\n            <form onSubmit={this.submitGuess}>\n              <input type=\"text\" name=\"guess\" onChange={this.handleChange}/>\n              <input className=\"submit-guess button\" type=\"submit\" value=\"Submit Answer\" />\n            </form>\n          </div>\n        )\n  }\n\n\n  render() {\n    return this.state.quizCategory\n        ? this.renderPlay()\n        : this.renderPrePlay()\n  }\n}\n\nexport default QuizView;\n"]},"metadata":{},"sourceType":"module"}